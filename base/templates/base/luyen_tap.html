<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luyện Tập - {{ bai.name }}</title>
    <style>
        .answer {
            padding: 10px;
            margin: 5px;
            border: 1px solid #ddd;
            cursor: pointer;
            display: inline-block;
        }
    </style>
    <script>
        function sendAnswer(questionId, answer) {
            fetch("{% url 'answer_view' %}", {
                method: "POST",
                headers: {
                    "Content-Type": "application/x-www-form-urlencoded",
                    "X-CSRFToken": "{{ csrf_token }}",
                },
                body: `question_id=${questionId}&answer=${answer}`
            })
            .then(response => response.json())
            .then(data => {
                const questionContainer = document.getElementById("question-container");

                if (data.type === "question") {
                    // Hiển thị câu hỏi tiếp theo
                    questionContainer.innerHTML = `
                        <h2>${data.question.name}</h2>
                        <div class="answer" onclick="sendAnswer(${data.question.id}, 'A')">A. ${data.question.answers.A}</div>
                        <div class="answer" onclick="sendAnswer(${data.question.id}, 'B')">B. ${data.question.answers.B}</div>
                        <div class="answer" onclick="sendAnswer(${data.question.id}, 'C')">C. ${data.question.answers.C}</div>
                        <div class="answer" onclick="sendAnswer(${data.question.id}, 'D')">D. ${data.question.answers.D}</div>
                    `;
                } else if (data.type === "result") {
                    // Hiển thị kết quả
                    questionContainer.innerHTML = `
                        <h2>Kết quả</h2>
                        <p>Số câu đúng: ${data.score} / ${data.total}</p>
                    `;
                }
            })
            .catch(error => console.error("Error:", error));
        }
    </script>
</head>
<body>
    <h1>Luyện Tập - {{ bai.name }}</h1>
    <div id="question-container">
        {% if question %}
            <h2>{{ question.name }}</h2>
            <div class="answer" onclick="sendAnswer('{{ question.id }}', 'A')">A. {{ question.Ans_a }}</div>
            <div class="answer" onclick="sendAnswer('{{ question.id }}', 'B')">B. {{ question.Ans_b }}</div>
            <div class="answer" onclick="sendAnswer('{{ question.id }}', 'C')">C. {{ question.Ans_c }}</div>
            <div class="answer" onclick="sendAnswer('{{ question.id }}', 'D')">D. {{ question.Ans_d }}</div>
        {% else %}
            <p>Không có câu hỏi nào để hiển thị.</p>
        {% endif %}
    </div>
</body>
</html>
